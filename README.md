# プライズフィギュア情報サービス

## 1. サービス概要
プライズフィギュアの重心や相場などの情報をまとめて閲覧・管理できる Web アプリケーションです。

## 2. 機能

### 2.1 ログイン機能
- パスワードは `pwd_hash` 関数でハッシュ化して保存  
- ログイン時にランダムなアクセスキーを発行し、セッションで保持

### 2.2 お気に入り機能
- ログインユーザのみ利用可能  
- お気に入り登録すると `favorite` テーブルにユーザID・フィギュアID を追加  
- 登録済みのお気に入り一覧ページを提供

### 2.3 重心登録（投票）機能
- 各フィギュアの重心に対してユーザ投票を実装  
- 投票後、一定期間は再投票を不可に（セッション管理）  
- 投票を受けると `figure` テーブル内の各重心カウントをインクリメント

### 2.4 フィギュアリクエスト登録機能
- 登録されていないフィギュアをリクエスト可能  
- リクエスト時にメモを添付し、運営が意図を把握しやすいように

### 2.5 フィギュア登録機能
- 管理者画面からフィギュア名、発売日などのメタ情報を登録

### 2.6 管理者ログイン機能
- ユーザ側と同様の仕組みで管理画面へのアクセスを制御

### 2.7 リクエスト一覧・承認機能
- 登録リクエストの一覧表示  
- 「登録」ボタンで該当データをフィギュア登録画面に自動入力  
- 不要なリクエストは削除可能

### 2.8 自動相場検索機能
- Python（Selenium）で Mercari をスクレイピング  
- 検索結果ページのスクリーンショットを OpenAI（ChatGPT API）で解析  
- 解析した平均価格を取得し、DB に反映するスクリプト

## 3. 使用技術

### 3.1 言語・フレームワーク
- **バックエンド**: PHP（スクラッチ実装）  
- **フロントエンド**: HTML / CSS / JavaScript  
- **自動化スクリプト**: Python（Selenium, OpenAI API）

### 3.2 ローカル開発環境
- **Docker**  
  - `apache+php` コンテナ  
  - `mysql` コンテナ  
  - `phpMyAdmin` コンテナ

### 3.3 ソース管理
- Git

### 3.4 本番環境
- **アプリケーションサーバ**: AWS EC2（Apache, PHP, MySQL, phpMyAdmin）  
- **データベースサーバ**: AWS RDS  
- **ドメイン**:  
  - ユーザ画面用サブドメイン  
  - 管理画面用サブドメイン  
  - phpMyAdmin 用サブドメイン

### 3.5 環境変数管理
- `.env` ファイルを使用し、APIキーや DB 接続情報をベタ書きせずに管理

### 3.6 CI/CD
- GitHub Actions  
  - `main` ブランチへのマージをトリガーに EC2 上で `git pull` → サービス再起動

